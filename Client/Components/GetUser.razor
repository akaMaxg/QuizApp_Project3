@using QuizApp_Project3.Shared.ViewModels;
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@using System.Net.Http.Json
@using System.Security.Claims
@inject HttpClient Http
@inject AuthenticationStateProvider AuthenticationStateProvider


<h3>Quizpage</h3>
@foreach (var quiz in listQuiz)
{
    <div class="quiz-item">
        <h3>@quiz.Title</h3>
        <p>Created: @quiz.Created.ToString("MM/dd, HH:mm")</p>
        <p>Number of Attempts: @quiz.NumberOfAttempts</p>
        <p>Score: @quiz.Score</p>
    </div>
}

<button @onclick=" HandleUserData">Get quizzes</button>


@code {
    //Messages
    private string message = "No calls made";
    private string questionMessage = "";

    //Initiatlized models
    private List<QuizViewModel> listQuiz = new List<QuizViewModel> { };

}

 @*User*@
@code {
    private async Task<List<QuizViewModel>> GetUserData()
    {
        var response = await Http.GetAsync("/quiz/userquiz");
        if (response.IsSuccessStatusCode)
        {
            var quizzes = await response.Content.ReadFromJsonAsync<List<QuizViewModel>>();
            return quizzes;
        }
        else
        {
            return null;
        }
    }
    private async Task HandleUserData()
    {
        var quizzes = await GetUserData();
        listQuiz = quizzes;
        StateHasChanged();
    }
}